# 掌纹的身份识别任务
为了获取目标手部图像，我们首先对手部图像进行手掌提取操作，以得到目标手掌图像。通过手掌提取的过程，我们可以减少手部图像中对掌纹特征的影响因素，从而提高掌纹特征的准确性。这一步骤有助于提取手部图像中最关键的区域，即手掌部分，以便后续的特征提取和分析。
接下来，我们调用特征提取模型对目标手掌图像进行特征提取。在本实验中，我们采用了ResNet-18深度学习网络作为特征提取模型。通过该模型，我们可以从目标手掌图像中提取出具有代表性的掌纹特征。这些掌纹特征可以用于身份识别和属性值预测等任务。
针对身份识别任务，我们使用ResNet-18深度学习网络进行训练。在测试集上，身份识别任务达到了70%的准确率。这表明我们训练的模型在对手掌图像进行身份识别方面取得了一定的成功。
## 1数据预处理
数据预处理的目的在于减少数据集内数据分布的差异性，有减少类内距离的同时增加类间距离的实际效果。在手部数据处理方面，我们使用关节检测从双手图像中识别到手的关键节点，通过这一部分的返回值可以确定是一只手还是两只手，如果是两只手的话，我们根据图像文件的命名来区分是左手掌向上还是右手掌向上，然后根据区分的结果来决定保留那一部分。（以2023-3-6-1.jpg为例，根据规范的命名规则，这张图片是右手掌向上的，我们保留右边的手掌）。至此，我们得到了单只手掌且掌心向上的数据集。
<p align="center">
  <img width="350" height="400" src=./fig/flowchat.png>
</p>
<p align="center">图1 获取单只手掌（掌心向上）的数据集</p>

得到单手掌数据集后，因为掌纹识别只用到手掌心，所以我们应该切割图像将手掌心部分提取出来。通过关节检测，利用指定的关节点坐标，将掌心区域分割出来得到最终的数据处理结果（如下图，我们选取0、1、5、9、13、17这六个点组成的区域）。

<p align="center">
  <img width="350" height="400" src=./fig/joint_detection.png>
</p>
<p align="center">图2 对单只手进行关节检测</p>
最后，按照8:1:1的比例来拆分出训练集、验证集、测试集。
## 2身份ID识别
### 2.1数据增强
在本实验中，为了增强手掌图像的质量和多样性，我们采用了图像数据增强技术。数据增强是通过对原始图像应用一系列变换操作来生成新的训练样本，从而扩充数据集的大小和多样性，提高机器学习模型的鲁棒性和性能。

首先，我们将彩色图像转换为灰度图像，以减少颜色通道对训练的影响，同时保留手掌图像的结构信息。接下来，我们随机地对图像进行裁剪，并调整长宽比，以模拟手掌图像在不同比例下的观察情况。这有助于训练模型对手掌图像尺度的变化具有鲁棒性。然后，我们对图像进行随机旋转，最多旋转15度，以增加模型对手掌图像姿势变化的识别能力。在裁剪和旋转之后，我们进行中心裁剪，将图像的尺寸调整为224x224像素，以便与常用的卷积神经网络模型兼容。最后，我们将图像转换为张量（Tensor）类型，并对图像进行标准化，使其像素值在[0, 1]范围内，并按照给定的均值和标准差进行归一化。这有助于提高模型的训练稳定性和收敛速度。

对于验证集（'valid'），我们采取类似的数据增强操作，但是没有进行随机裁剪和旋转，而是将图像进行缩放和中心裁剪，以保持一致的图像大小和模型输入尺寸。通过这些数据增强操作，我们能够生成更多样化和鲁棒性的手掌图像样本，从而提高模型的泛化能力和准确性。

### 2.2构建数据加载器
为了进行训练和验证，我们使用了PyTorch中的数据加载模块。首先，我们定义了一个名为data的字典，其中包含训练集和验证集的图像文件夹路径以及相应的数据增强转换操作。
对于训练集，我们使用了datasets.ImageFolder类来加载图像文件夹，并应用了image_transforms['train']所定义的数据增强操作；对于验证集，我们同样使用了datasets.ImageFolder类来加载图像文件夹，并应用了image_transforms['valid']所定义的数据增强操作。

然后，我们使用DataLoader类来创建训练集和验证集的数据加载器。数据加载器能够批量地加载和处理数据，提供了更高效的数据读取和处理方式。我们设置了batch_size参数来指定每个批次的样本数量，并将shuffle参数设置为True，以在每个训练迭代中对数据进行洗牌，增加训练的随机性。

通过使用数据加载器，我们可以方便地迭代遍历训练集和验证集，将数据提供给模型进行训练和评估。

### 2.3 resent18网络
我们使用了ResNet-18作为基础模型，并根据任务的需要对其进行了修改和微调。首先，我们通过models.resnet18()创建了一个ResNet-18模型的实例，并将其赋值给resnet18变量。
然后，我们通过修改ResNet-18的全连接层，将其适应于我们的手掌识别任务。我们首先获取原始全连接层的输入特征数量fc_x，然后定义了一个新的全连接层。新的全连接层包含两个线性层和一个ReLU激活函数层。第一个线性层将输入特征数量减少为256，接着应用了一个Dropout层，以防止过拟合。最后，因为数据集中一共有32个人的手掌数据，我们将输出特征数量设置为32，以匹配任务的输出类别数量。

在定义网络模型后，我们需要选择适当的损失函数和优化器来训练模型。本实验中，我们选择交叉熵损失函数（nn.CrossEntropyLoss()）作为我们的目标函数，用于类别分类任务。对于优化器，我们使用Adam优化器（optim.Adam）来更新模型的参数，设置学习率为1e-3。
### 2.4 实验结果
<p align="center">
  <img width="350" height="400" src=./fig/result.png>
</p>
<p align="center"> 图3 训练结果曲线图和验证结果曲线图 </p>

如图3右图所示，训练准确率曲线在初始阶段（epochs=0到250）呈快速上升的趋势，表明模型在训练数据上得到了有效的学习。随着训练的进行，训练准确率逐渐接近收敛状态，并最终稳定在97%左右，表明模型在训练数据上取得了很高的准确率。

然而，与训练准确率曲线相比，验证准确率曲线的波动幅度较大。从图中观察可以看出，验证准确率曲线在初始阶段（epochs=0到300）缓慢上升，随后基本达到了一个稳定状态，大约为71.52%。这意味着模型在验证数据上的性能相对较低，并且泛化性能有待进一步提高。
